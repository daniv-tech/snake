<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <title>Snake</title>

    <style>
        body {
            background: chocolate;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        canvas {
            border: 1px solid #000;
        }
    </style>
</head>
<body>
<canvas height="300" id="snake" width="300"></canvas>

<div id="debug"></div>
<script>
    const canvas = document.getElementById('snake')
    const ctx = canvas.getContext('2d')

    const ratio = 1 //window.devicePixelRatio;
    let canvasWidth = canvas.width
    let canvasHeight = canvas.height

    const xMax = canvasWidth * ratio
    const yMax = canvasHeight * ratio

    if (ratio > 1) {
        canvas.width = xMax
        canvas.height = yMax
        canvas.style.width = canvasWidth + 'px'
        canvas.style.height = canvasHeight + 'px'

        ctx.scale(ratio, ratio)
    }

    const snakeSize = 10
    const snakeSpace = 0

    const directions = ['top', 'bottom', 'left', 'right']
    const direction = directions[Math.floor(Math.random() * directions.length)]

    const snakeBodyPoints = [
        [xMax / 2 / ratio, yMax / 2 / ratio],
        [xMax / 2 / ratio + snakeSize, yMax / 2 / ratio],
    ]

    let step = 0

    const interval = setInterval(() => {
        for (let bodyPontIndex = 0; bodyPontIndex < snakeBodyPoints.length; bodyPontIndex++) {
            const [x, y] = snakeBodyPoints[bodyPontIndex]

            let newX = x
            let newY = y

            ctx.clearRect(x, y, snakeSize, snakeSize)

            if (direction === 'left' || direction === 'right') {
                if (direction === 'left') {
                    newX = x - snakeSize
                } else {
                    newX = x + snakeSize
                }
            } else {
                if (direction === 'top') {
                    newY = y - snakeSize
                } else {
                    newY = y + snakeSize
                }
            }

            // if (bodyPontIndex !== 0 & step === 0) {
            //   newX = newX + snakeSpace;
            // }

            if (newX < 0) {
                newX = canvas.width - snakeSize
            } else if (newX > canvas.width) {
                newX = 0 + snakeSize
            }

            if (newY < 0) {
                newY = canvas.height - snakeSize
            } else if (newY > canvas.height) {
                newY = 0 + snakeSize
            }

            ctx.fillStyle = 'red'
            ctx.fillRect(newX, newY, snakeSize, snakeSize)

            snakeBodyPoints[bodyPontIndex] = [newX, newY]
        }

        // ctx.beginPath();
        // ctx.arc(snakeBodyPoints[0][0], snakeBodyPoints[0][1] + 3, 2, 0, Math.PI * 2);
        // ctx.fillStyle = 'white';
        // ctx.fill();
        // ctx.arc(snakeBodyPoints[0][0], snakeBodyPoints[0][1] + 7, 2, 0, Math.PI * 2);
        // ctx.fill();

        // ctx.fillStyle = 'black';
        // ctx.fillRect(snakeBodyPoints[0][0] - 1, snakeBodyPoints[0][1] + 3, 1, 1);
        // ctx.fillRect(snakeBodyPoints[0][0] - 1, snakeBodyPoints[0][1] + 6, 1, 1);
        // ctx.closePath();

        debug()
        ++step
    }, 20000)


    // ctx.beginPath();
    // ctx.arc(151, 152, 2, 0, Math.PI * 2);
    // ctx.fillStyle = 'white';
    // ctx.fill();
    // ctx.closePath();

    // ctx.fillStyle = 'black';
    // ctx.fillRect(149, 152, 1, 1);

    // ctx.beginPath();
    // ctx.arc(151, 158, 2, 0, Math.PI * 2);
    // ctx.fillStyle = 'white';
    // ctx.fill();
    // ctx.closePath();

    // ctx.fillStyle = 'black';
    // ctx.fillRect(149, 157, 1, 1);

    // ctx.fillText('üçì', 80, 155)

    function debug() {
        document.getElementById('debug').innerHTML = JSON.stringify(snakeBodyPoints)
    }
</script>
</body>
</html>
